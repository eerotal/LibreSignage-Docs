<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: node_modules/libresignage/ui/components/MultiSelect/MultiSelect.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: node_modules/libresignage/ui/components/MultiSelect/MultiSelect.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var Assert = require('assert');
var ValidatorSelector = require('libresignage/ui/validator/ValidatorSelector');
var ValidatorTrigger = require('libresignage/ui/validator/ValidatorTrigger');
var AlertDialog = require('libresignage/ui/components/Dialog/AlertDialog');

/**
* @typedef {object} MultiSelectSettings
*
* @property {boolean} nodups  Allow duplicate selections.
* @property {number}  maxopts The maximum number of selections allowed.
*
* @memberof module:libresignage/ui/components
* @alias    MultiSelectSettings
*/

/**
* A UI component that allows the user to write an input and add it to
* a list of selections.
*
* @memberof module:libresignage/ui/components
*/
class MultiSelect {
	/**
	* Construct a new MultiSelect object.
	*
	* @param {string}              container_id The ID of the container where
	*                                           the MultiSelect is created.
	* @param {string}              ms_id        The ID of the MultiSelect to
	*                                           create.
	* @param {BaseValidator[]}     validators   An array of validators to use
	*                                           for the MultiSelect input.
	* @param {MultiSelectSettings} settings     A settings object.
	*
	* @throws {AssertionError} If the supplied container_id is invalid.
	* @throws {AssertionError} If the supplied ms_id is invalid.
	*/
	constructor(container_id, ms_id, validators, settings) {
		Assert.ok(container_id != null, "Invalid container ID.");
		Assert.ok(ms_id != null, "Invalid MultiSelect ID.");

		this.enabled = true;
		this.val_valid = true;
		this.selected = [];
		this.settings = settings;

		this.container = document.getElementById(container_id);
		this.container.innerHTML = MultiSelect.make_html(ms_id)

		this.input = this.container.querySelector('.ms-controls > .ms-input');
		this.btn_add = this.container.querySelector('.ms-controls > .ms-add');
		this.values = this.container.querySelector('.ms-values');

		// Add a listener for Enter keypresses.
		this.input.addEventListener('keypress', (event) => {
			if (event.key == 'Enter' &amp;&amp; this.val_valid) {
				this.add(this.input.value);
				this.input.value = '';
				this.vtrig.validate_all();
			}
		});

		// Add a listener for the (+) button.
		this.btn_add.addEventListener('click', () => {
			this.add(this.input.value);
			this.input.value = '';
		});

		// Add validators for the input.
		if (validators &amp;&amp; validators.length) {
			(this.vtrig = new ValidatorTrigger(
				[
					new ValidatorSelector(
						this.input,
						this.container,
						validators,
						null
					)
				],
				valid => {
					this.val_valid = valid;
					this.btn_add.disabled = !valid;
				}
			)).trigger();
		}
	}

	/**
	* Create the HTML for a MultiSelect.
	*
	* @param {string} ms_id The DOM ID to use for the MultiSelect.
	*/
	static make_html(ms_id) {
		return `
			&lt;div id="${ms_id}" class="multiselect container-fluid">
				&lt;div class="ms-controls container-fluid">
					&lt;input class="ms-input col form-control" type="text">
					&lt;button class="ms-add col btn btn-primary" type="button">
						&lt;i class="fas fa-plus-circle">&lt;/i>
					&lt;/button>
					&lt;div class="invalid-feedback">&lt;/div>
				&lt;/div>
				&lt;div class="ms-values container-fluid">&lt;/div>
			&lt;/div>
		`;
	}

	/**
	* Get the value of a setting.
	*
	* @param {string} name The name of the setting.
	*
	* @return {mixed} The value of the requested setting or null if
	*                 no such setting exists.
	*/
	get_setting(name) {
		if (name in this.settings) {
			return this.settings[name];
		} else {
			return null;
		}
	}

	/**
	* Select a new option.
	*
	* If the 'nodups' setting is true and 'option' is already selected
	* this function returns without changing anything. If the number of
	* selections would exceed the 'maxopts' setting, this function displays
	* a dialog indicating that and returns.
	*
	* @param {string} option The option to select.
	*/
	add(option) {
		if (option == null) { return; }

		if (this.get_setting('nodups') &amp;&amp; this.selected.includes(option)) {
			return;
		}

		if (
			this.get_setting('maxopts')
			&amp;&amp; this.selected.length >= this.get_setting('maxopts')
		) {
			let dialog = new AlertDialog(
				"Too many selections",
				"The maximum amount of selections has been reached.",
				() => {}
			);
			return;
		}

		let div = document.createElement('div');
		div.id = `ms-opt-${option}`;
		div.classList.add('ms-val');
		div.innerHTML = `${option}&lt;span class="ms-rm fas fa-times">&lt;/span>`;
		this.values.appendChild(div);

		div.querySelector('.ms-rm').addEventListener(
			'click',
			() => this.remove(option)
		);

		this.selected.push(option);
	}

	/**
	* Select a set of options.
	*
	* This function clears any previous selections.
	*
	* @param {string[]} options An array of options to select.
	*/
	set(options) {
		this.selected = [];
		this.values.innerHTML = '';
		for (let o of options) { this.add(o); }
	}

	/**
	* Remove a selection.
	*
	* @param {string} option The selection to remove.
	*
	* @throws {AssertionError} If 'option' is not selected.
	*/
	remove(option) {
		Assert.ok(this.selected.includes(option), "Option not selected.");
		this.container.querySelector(`#ms-opt-${option}`).outerHTML = '';
		this.selected.splice(this.selected.indexOf(option), 1);
	}

	/**
	* Enable a MultiSelect.
	*/
	enable() {
		this.enabled = true;
		this.input.disabled = false;
		for (let s of this.vtrig.selectors) { s.enable(true); }

		this.values.setAttribute('style', 'background-color: white;');
		for (let e of this.container.querySelectorAll('.ms-rm')) {
			e.setAttribute('style', 'display: inline;');
		}
	}

	/**
	* Disable a MultiSelect.
	*/
	disable() {
		this.enabled = false;
		this.input.disabled = true;
		this.btn_add.disabled = true;
		for (let s of this.vtrig.selectors) { s.enable(false); }

		this.values.setAttribute('style', 'background-color: var(--gray-3);');
		for (let e of this.container.querySelectorAll('.ms-rm')) {
			e.setAttribute('style', 'display: none;');
		}
	}

	/**
	* Get selected options as an array.
	*
	* @param {string[]} The selected options as an array of strings.
	*/
	get_selected() {
		return this.selected;
	}
}
module.exports = MultiSelect;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-libresignage_api.html">libresignage/api</a></li><li><a href="module-libresignage_misc.html">libresignage/misc</a></li><li><a href="module-libresignage_queue.html">libresignage/queue</a></li><li><a href="module-libresignage_slide.html">libresignage/slide</a></li><li><a href="module-libresignage_ui_components.html">libresignage/ui/components</a></li><li><a href="module-libresignage_ui_components_Dialog.html">libresignage/ui/components/Dialog</a></li><li><a href="module-libresignage_ui_controller.html">libresignage/ui/controller</a></li><li><a href="module-libresignage_ui_validator.html">libresignage/ui/validator</a></li><li><a href="module-libresignage_user.html">libresignage/user</a></li><li><a href="module-libresignage_util.html">libresignage/util</a></li></ul><h3>Namespaces</h3><ul><li><a href="module-libresignage_api.APIEndpoints.html">APIEndpoints</a></li><li><a href="module-libresignage_api.HTTPStatus.html">HTTPStatus</a></li><li><a href="module-libresignage_slide.Animations.html">Animations</a></li></ul><h3>Classes</h3><ul><li><a href="APIInterface.html">APIInterface</a></li><li><a href="AssetList.html">AssetList</a></li><li><a href="AssetUploader.html">AssetUploader</a></li><li><a href="AssetUploaderController.html">AssetUploaderController</a></li><li><a href="ControlPanelController.html">ControlPanelController</a></li><li><a href="ControlPanelView.html">ControlPanelView</a></li><li><a href="DisplayController.html">DisplayController</a></li><li><a href="DisplayView.html">DisplayView</a></li><li><a href="EditorController.html">EditorController</a></li><li><a href="LoginController.html">LoginController</a></li><li><a href="LoginView.html">LoginView</a></li><li><a href="LogoutController.html">LogoutController</a></li><li><a href="LogoutView.html">LogoutView</a></li><li><a href="module-libresignage_api.APIError.html">APIError</a></li><li><a href="module-libresignage_api.APISession.html">APISession</a></li><li><a href="module-libresignage_misc.Shortcut.html">Shortcut</a></li><li><a href="module-libresignage_misc.ShortcutController.html">ShortcutController</a></li><li><a href="module-libresignage_misc.Timeout.html">Timeout</a></li><li><a href="module-libresignage_queue.Queue.html">Queue</a></li><li><a href="module-libresignage_queue.SlideList.html">SlideList</a></li><li><a href="module-libresignage_queue.SlideListIterator.html">SlideListIterator</a></li><li><a href="module-libresignage_slide.Slide.html">Slide</a></li><li><a href="module-libresignage_ui_components.BaseComponent.html">BaseComponent</a></li><li><a href="module-libresignage_ui_components.DropConfirm.html">DropConfirm</a></li><li><a href="module-libresignage_ui_components.DropSelect.html">DropSelect</a></li><li><a href="module-libresignage_ui_components.MultiSelect.html">MultiSelect</a></li><li><a href="module-libresignage_ui_components.Popup.html">Popup</a></li><li><a href="module-libresignage_ui_components_Dialog.AlertDialog.html">AlertDialog</a></li><li><a href="module-libresignage_ui_components_Dialog.APIErrorDialog.html">APIErrorDialog</a></li><li><a href="module-libresignage_ui_components_Dialog.BaseDialog.html">BaseDialog</a></li><li><a href="module-libresignage_ui_components_Dialog.ConfirmDialog.html">ConfirmDialog</a></li><li><a href="module-libresignage_ui_components_Dialog.PromptDialog.html">PromptDialog</a></li><li><a href="module-libresignage_ui_components_Dialog.SelectDialog.html">SelectDialog</a></li><li><a href="module-libresignage_ui_controller.UIButton.html">UIButton</a></li><li><a href="module-libresignage_ui_controller.UIElem.html">UIElem</a></li><li><a href="module-libresignage_ui_controller.UIInput.html">UIInput</a></li><li><a href="module-libresignage_ui_controller.UIStatic.html">UIStatic</a></li><li><a href="module-libresignage_ui_validator.BaseValidator.html">BaseValidator</a></li><li><a href="module-libresignage_ui_validator.BlacklistValidator.html">BlacklistValidator</a></li><li><a href="module-libresignage_ui_validator.EqValidator.html">EqValidator</a></li><li><a href="module-libresignage_ui_validator.FileSelectorValidator.html">FileSelectorValidator</a></li><li><a href="module-libresignage_ui_validator.NumValidator.html">NumValidator</a></li><li><a href="module-libresignage_ui_validator.StrValidator.html">StrValidator</a></li><li><a href="module-libresignage_ui_validator.ValidatorController.html">ValidatorController</a></li><li><a href="module-libresignage_ui_validator.ValidatorSelector.html">ValidatorSelector</a></li><li><a href="module-libresignage_ui_validator.ValidatorTrigger.html">ValidatorTrigger</a></li><li><a href="module-libresignage_ui_validator.WhitelistValidator.html">WhitelistValidator</a></li><li><a href="module-libresignage_user.Quota.html">Quota</a></li><li><a href="module-libresignage_user.User.html">User</a></li><li><a href="module-libresignage_util.Cookie.html">Cookie</a></li><li><a href="module-libresignage_util.UIUtil.html">UIUtil</a></li><li><a href="module-libresignage_util.Util.html">Util</a></li><li><a href="Preview.html">Preview</a></li><li><a href="QueueSelector.html">QueueSelector</a></li><li><a href="SessionList.html">SessionList</a></li><li><a href="SlideAsset.html">SlideAsset</a></li><li><a href="Timeline.html">Timeline</a></li><li><a href="UIController.html">UIController</a></li><li><a href="UserController.html">UserController</a></li><li><a href="UserList.html">UserList</a></li><li><a href="UserListEntry.html">UserListEntry</a></li><li><a href="UserManagerController.html">UserManagerController</a></li><li><a href="UserManagerView.html">UserManagerView</a></li><li><a href="UserValidators.html">UserValidators</a></li><li><a href="UserView.html">UserView</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Sun Oct 25 2020 10:27:27 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
